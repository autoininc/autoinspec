<!DOCTYPE html>
<html lang="en" >

<head>
<%- include ('../layout/head.ejs') -%>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

</head>

<body>
    <div class="container-scroller">
        <%- include ('../layout/header.ejs') -%>

        <div class="container-fluid page-body-wrapper">
            <div class="main-panel">
              <div class="content-wrapper" style="padding-left: 15px; padding-right: 15px; background-color: #f0f3f6;">
                <div class="row">
                  <div class="col-md-3"></div>
                  <div class="col-md-6 grid-margin stretch-card">
                    <div class="card">
                      <div class="card-body">
                        <h4 class="card-title">Change Password</h4>
                        
                        <div class="table-responsive pt-3">
                          <form id="changeForm">
                          <table class="table table-bordered">
                            <tbody>
                              <tr>
                                <th style="width: 25%;">Current password</th>
                                <td><input type="password" class="form-control form-control-lg" id="current_password" name="current_password"></td>
                              </tr>
                              <tr>
                                <th style="width: 25%;">New password</th>
                                <td><input type="password" class="form-control form-control-lg" id="password" name="password"></td>
                              </tr>
                              <tr>
                                <th style="width: 25%;">Confirm password</th>
                                <td><input type="password" class="form-control form-control-lg" id="password_check" name="password_check"></td>
                              </tr>
                            </tbody>
                          </table>
                        </form>
                        </div>
                        <div class="card-body"><button class="btn btn-light" onclick="change();">Change</button></div>
                      </div>
                      
                    </div>
                  </div>
                  <div class="col-md-3"></div>
                </div>
              </div>
              <!-- content-wrapper ends -->
              <!-- partial:../../partials/_footer.html -->
              <%- include ('../layout/footer.ejs') -%>
              <!-- partial -->
            </div>
            <!-- main-panel ends -->
          </div>
    </div>

<script>


function change() {


    var formData = $("form[id=changeForm]").serialize();

      $.ajax({
          type: "POST",
          url: "/account/password",
          data: formData,
          processData: false,
          cache: false,
          success: function (data) {
              alert(data.msg);
              if (data.state == '3') {
                window.location.href = '/user/logout';
              } 
          },
          error: function (e) {
            console.log("ERROR : ", e);
          }
    });

}


</script>

</body>
</html>